---
layout: post
title: MyBB 1.6.5
permalink: 165.html
category: Versions
---
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Release_Date"><span class="tocnumber">1</span> <span class="toctext">Release Date</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Announcement_Summary"><span class="tocnumber">2</span> <span class="toctext">Announcement Summary</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Overview"><span class="tocnumber">2.1</span> <span class="toctext">Overview</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Security_Vulnerabilities"><span class="tocnumber">2.2</span> <span class="toctext">Security Vulnerabilities</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Template_System_Changes"><span class="tocnumber">2.3</span> <span class="toctext">Template System Changes</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Feature_Updates"><span class="tocnumber">2.4</span> <span class="toctext">Feature Updates</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Changed_Files"><span class="tocnumber">2.5</span> <span class="toctext">Changed Files</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Language_Changes"><span class="tocnumber">2.6</span> <span class="toctext">Language Changes</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Plugin_System_Changes"><span class="tocnumber">2.7</span> <span class="toctext">Plugin System Changes</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="#Addendum"><span class="tocnumber">2.7.1</span> <span class="toctext">Addendum</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</td></tr></table>

<p>MyBB 1.6.5 was released November 25, 2011.
</p>


<p>1.6.5 is a medium-sized security, maintenance and feature upgrade for the 1.6 series. There are several new changes in this version which can help you find Spam users on your forum. These are explained below.
</p>

<p>1.6.5 fixes 3 vulnerabilities. These are:
</p><p><b>Non-Critical</b>
</p>
<ul><li> An issue with an unparsed user avatar in the buddy list - reported by labrocca
</li><li> Potential XSS vulnerability with validating usernames via AJAX - reported by Will G
</li></ul>
<p>These are rated as non-critical due to their obscure methods of execution.
</p><p><b>Low Risk</b>
</p>
<ul><li> CSRF vulnerability in&#160;?language - <a rel="nofollow" class="external text" href="http://dev.mybb.com/issues/1729">Issue 1729</a>
</li></ul>

<p>In 1.6.4, a change was made to the templates system that denied the use of the $config data array. This has been changed so that only the database password cannot be accessed.
</p>

<p>Feature updates can be small or large changes to the way MyBB features work. The following changes have been made in 1.6.5.
</p>
<ul><li> <b>Birthdays</b>
</li></ul>
<dl><dd><dl><dd>There are 2 new settings that affect Birthdays. In the Forum Home settings, 'Only Show Birthdays with x Posts' allows you to limit users with a certain post count appearing in the birthday list on the forum index. This is a global setting that affects all users. In the usergroup settings, under the Miscellaneous tab, 'Can be shown in the birthday list?' can toggle whether users in the usergroup will appear in the birthday list on the forum index.
</dd></dl>
</dd></dl>
<ul><li> <b>Signature Control</b>
</li></ul>
<dl><dd><dl><dd>There are 3 new settings that affect Signatures - all are usergroup settings. Under the Users and Permissions tab, 'Can add a signature' and 'Required Post Count Before Signature Can Be Added' limits if and when the user can add a signature. 'Signature links have nofollow enabled?' will automatically make links posted in a signature a nofollow link.
</dd></dl>
</dd></dl>
<ul><li> <b>Find Users</b>
</li></ul>
<dl><dd><dl><dd>There are some changes to the Admin Control Panel (ACP) Users &amp; Groups Find Users panel. Previously you had to enter text in a field to search for. Now you can search for fields that are not empty - for example, if they anything set for that field. This will allow you to search for users that have added a website, set a signature or updated their Bio - traditional traits of a spammer - from inside the ACP without having to enter something specific. There is also a new field - 'Registered in the last x days'. This will limit the search for users that have registered in a given time frame.
</dd></dl>
</dd></dl>
<ul><li> <b>Custom Profile Fields</b>
</li></ul>
<dl><dd><dl><dd>Within custom profile fields, there is now a new option to set a minimum post count. Only users with a certain amount of posts will be able to complete these fields.
</dd></dl>
</dd></dl>
<ul><li> <b>Hidden CAPTCHA</b>
</li></ul>
<dl><dd><dl><dd>It is now possible to use a hidden CAPTCHA, a 'honeypot' field that typically only spam bots will fill in, that can be configured from the ACP. Under the User Registration and Profile Options settings, the 'Display a hidden CAPTCHA' setting will turn this on or off (off by default), and the 'Hidden CAPTCHA field' setting will be the name of this field in the registration form. If this field is filled in, the registration will be denied.
</dd></dl>
</dd></dl>
<ul><li> <b>reCAPTCHA</b>
</li></ul>
<dl><dd><dl><dd>The ability to choose between the MyBB CAPTCHA or reCAPTCHA was added in 1.6.5. In the General Configuration settings, you can choose reCAPTCHA from the 'CAPTCHA Images for Registration &amp; Posting' setting. Please note that to use reCAPTCHA you must have a public and private key. You can get these by creating an account on the <a rel="nofollow" class="external text" href="http://www.google.com/recaptcha/whyrecaptcha">reCAPTCHA website</a>. Please note that if you use reCAPTCHA and have guest posting turned on, a guest must enter the challenge when they preview a post too.
</dd></dl>
</dd></dl>
<ul><li> <b>Reputation</b>
</li></ul>
<dl><dd><dl><dd>From 1.6.5, you can now disable negative and/or neutral and/or postitive reputation. You can configure these in the Reputation settings. Please note that if you have no reputation options available, the reputation system will be disabled.
</dd></dl>
</dd></dl>
<p>Work is continuing on the Spam Ninja plugin, which lets you manage spam on your forum much more effectively. This will be coming in the near future.
</p>
<ul><li> <b>PM Override</b>
</li></ul>
<dl><dd><dl><dd>A new usergroup setting was added that enables the group to be able to send a PM to a user even if the recipients have them disabled. You can find this under the Users &amp; Permissions tab when editing a usergroup.
</dd></dl>
</dd></dl>
<ul><li> <b>Parent Forum Lightbulbs</b>
</li></ul>
<dl><dd><dl><dd>An experimental setting was added into 1.6.5 that attempts to mark parent forums as read if there are no more unread posts in a subforum. It's experimental because it could cause additional load on your forum if you have many subforums or is actively busy. Give it a try by switching it on in the Forum Display Configuration options and let us know how it goes in the <a rel="nofollow" class="external text" href="http://community.mybb.com/forum-7.html">1.6 Suggestions and Feedback</a> forum.
</dd></dl>
</dd></dl>

<p>The following files have changed since 1.6.4.
</p>
<ul><li> admin
<ul><li> inc
<ul><li> class_form.php
</li><li> class_page.php
</li><li> functions.php
</li></ul>
</li><li> jscripts
<ul><li> quick_perm_editor.js
</li></ul>
</li><li> modules
<ul><li> config
<ul><li> banning.php
</li><li> module_meta.php
</li><li> profile_fields.php
</li><li> settings.php
</li></ul>
</li><li> forum
<ul><li> management.php
</li><li> module_meta.php
</li></ul>
</li><li> home
<ul><li> index.php
</li><li> credits.php
</li><li> module_meta.php
</li></ul>
</li><li> style
<ul><li> module_meta.php
</li></ul>
</li><li> tools
<ul><li> adminlog.php
</li><li> module_meta.php
</li><li> system_health.php
</li><li> tasks.php
</li></ul>
</li><li> user
<ul><li> groups.php
</li><li> module_meta.php
</li><li> users.php
</li></ul>
</li></ul>
</li><li> styles
<ul><li> sharepoint
<ul><li> style.php
</li></ul>
</li></ul>
</li><li> index.php
</li></ul>
</li><li> inc
<ul><li> datahandlers
<ul><li> event.php
</li><li> pm.php
</li><li> post.php
</li><li> user.php
</li></ul>
</li><li> languages
<ul><li> english
<ul><li> admin
<ul><li> config_banning.lang.php
</li><li> config_languages.lang.php
</li><li> config_profile_fields.lang.php
</li><li> config_settings.lang.php
</li><li> forum_management.lang.php
</li><li> global.lang.php
</li><li> style_themes.lang.php
</li><li> tools_adminlog.php
</li><li> tools_maillogs.php
</li><li> tools_modlog.lang.php
</li><li> user_group_promotions.lang.php
</li><li> user_groups.lang.php
</li><li> user_mass_mail.lang.php
</li><li> user_users.lang.php
</li></ul>
</li><li> akismet.lang.php
</li><li> calendar.lang.php
</li><li> global.lang.php
</li><li> member.lang.php
</li><li> memberlist.lang.php
</li><li> modcp.lang.php
</li><li> moderation.lang.php
</li><li> newreply.lang.php
</li><li> newthread.lang.php
</li><li> online.lang.php
</li><li> private.lang.php
</li><li> reputation.lang.php
</li><li> usercp.lang.php
</li><li> warnings.lang.php
</li></ul>
</li><li> english.php
</li></ul>
</li><li> <span style="color: green;">class_captcha.php</span>
</li><li> class_core.php
</li><li> class_custommoderation.php
</li><li> class_mailhandler.php
</li><li> class_moderation.php
</li><li> class_parser.php
</li><li> class_plugins.php
</li><li> functions.php
</li><li> functions_forumlist.php
</li><li> functions_image.php
</li><li> functions_indicators.php
</li><li> functions_online.php
</li><li> functions_post.php
</li><li> functions_posting.php
</li><li> functions_upload.php
</li><li> functions_user.php
</li></ul>
</li><li> install
<ul><li> resources
<ul><li> <span style="color: green;">upgrade21.php</span>
</li></ul>
</li></ul>
</li><li> jscripts
<ul><li> editor.js
</li><li> inline_moderation.js
</li><li> thread.js
</li></ul>
</li><li> announcements.php
</li><li> captcha.php
</li><li> editpost.php
</li><li> forumdisplay.php
</li><li> <span style="color: red;">global.php</span>
</li><li> index.php
</li><li> member.php
</li><li> memberlist.php
</li><li> <span style="color: red;">misc.php</span>
</li><li> modcp.php
</li><li> moderation.php
</li><li> newreply.php
</li><li> newthread.php
</li><li> online.php
</li><li> polls.php
</li><li> ratethread.php
</li><li> reputation.php
</li><li> showteam.php
</li><li> showthread.php
</li><li> usercp.php
</li><li> warnings.php
</li><li> <span style="color: red;">xmlhttp.php</span>
</li></ul>
<p><span style="color: red;">Red represents files that contain security updates</span>
<br /><span style="color: green;">Green represents new files added in this release</span>
<br />
</p>

<p>The following language files have had changes made to them. Use a file difference tool to cross reference.
</p>
<ul><li> admin
<ul><li> config_banning.lang.php
</li><li> config_languages.lang.php
</li><li> config_profile_fields.lang.php
</li><li> config_settings.lang.php
</li><li> forum_management.lang.php
</li><li> global.lang.php
</li><li> style_themes.lang.php
</li><li> tools_adminlog.php
</li><li> tools_maillogs.php
</li><li> tools_modlog.lang.php
</li><li> user_group_promotions.lang.php
</li><li> user_groups.lang.php
</li><li> user_mass_mail.lang.php
</li><li> user_users.lang.php
</li></ul>
</li></ul>
<ul><li> akismet.lang.php
</li><li> calendar.lang.php
</li><li> global.lang.php
</li><li> member.lang.php
</li><li> memberlist.lang.php
</li><li> modcp.lang.php
</li><li> moderation.lang.php
</li><li> newreply.lang.php
</li><li> newthread.lang.php
</li><li> online.lang.php
</li><li> private.lang.php
</li><li> reputation.lang.php
</li><li> usercp.lang.php
</li><li> warnings.lang.php
</li></ul>
<p><br />
</p>

<p>Changes from <a rel="nofollow" class="external text" href="http://dev.mybb.com/issues/1373">Issue 1373</a>:
If you're using any of the following hooks in your plugins, you need to make sure you're returning the variable passed to it, as in 1.6.5 these were all switched from using $plugins-&gt;run_hooks_by_ref("func" $var) to $var = $plugins-&gt;run_hooks("func", $var) as passing by reference is now deprecated in PHP.
</p>
<ul><li>admin_config_menu
</li><li>admin_config_action_handler
</li><li>admin_config_permissions
</li><li>admin_home_menu
</li><li>admin_home_action_handler
</li><li>admin_home_menu_quick_access
</li><li>admin_user_menu
</li><li>admin_user_action_handler
</li><li>admin_user_permissions
</li><li>admin_user_groups_edit_graph_tabs
</li><li>admin_forum_management_permission_groups
</li><li>admin_forum_menu
</li><li>admin_forum_action_handler
</li><li>admin_forum_permissions
</li><li>admin_tools_menu
</li><li>admin_tools_action_handler
</li><li>admin_tools_menu_logs
</li><li>admin_tools_get_admin_log_action
</li><li>admin_tools_permissions
</li><li>admin_style_menu
</li><li>admin_style_action_handler
</li><li>admin_style_permissions
</li><li>admin_page_output_nav_tabs_start
</li><li>admin_page_output_tab_control_start
</li><li>admin_page_output_nav_tabs_start
</li><li>admin_form_output_submit_wrapper
</li><li>admin_formcontainer_output_row
</li><li>admin_tabs
</li><li>upload_avatar_end
</li><li>upload_attachment_do_insert
</li><li>upload_file_end
</li><li>my_date
</li><li>error
</li><li>redirect
</li><li>mycode_add_codebuttons
</li><li>functions_fetch_ban_times
</li><li>fetch_wol_activity_end
</li><li>build_friendly_wol_location_end
</li><li>parse_quoted_message
</li><li>postbit_prev
</li><li>postbit_pm
</li><li>postbit_announcement
</li><li>postbit
</li><li>build_forumbits_forum
</li><li>class_moderation_delete_post_start
</li></ul>
<p><br />
The following hooks are using the new version of $plugins-&gt;run_hooks_by_ref(), which instead of passing by ref, requires that you receive by ref.
</p>
<ul><li>admin_form_end
</li><li>datahandler_event_validate
</li><li>datahandler_event_insert
</li><li>datahandler_event_update
</li><li>datahandler_user_validate
</li><li>datahandler_user_insert
</li><li>datahandler_user_update
</li><li>datahandler_pm_validate
</li><li>datahandler_pm_insert_updatedraft
</li><li>datahandler_pm_insert
</li><li>datahandler_pm_insert_savedcopy
</li><li>datahandler_post_validate_post
</li><li>datahandler_post_insert_post
</li><li>datahandler_post_validate_thread
</li><li>datahandler_post_insert_thread
</li><li>datahandler_post_insert_thread_post
</li><li>datahandler_post_insert_thread
</li><li>datahandler_post_update_thread
</li><li>datahandler_post_update
</li></ul>
<p><br />
If you're using this hook:
send_mail_queue_mail
You will need to find an alternate solution since it is removed as of 1.6.5
</p><p>Changes from <a rel="nofollow" class="external text" href="http://dev.mybb.com/issues/1727">Issue 1727</a>:
In addition to these changes, we've added new code to make the memberlist_user hook more functional. You can unset $user['username'] in order to force a user to be skipped from the code block below the hook. This also means you can edit any element or add/remove elements from the $user array as well.
</p><p>The last change for plugin hooks in 1.6.5 is with the admin_formcontainer_end hook. We no longer pass $return as the argument, which never did anything anyways, instead we pass $hook, which is the following array:
$hook = array(
"return" =&gt; &amp;$return,
"this" =&gt; &amp;$this
)
Which, since the array is attached by ref, will allow you to edit either element in the array and have your edits work inside the code beyond the hook.
</p>

<p><span style="color:red">Due to a plugin that was already receiving by reference Stefan discovered you can use the receive by reference method for either of the plugin type changes. It was not intended functionality, but does make authoring/updating plugins much simpler.</span>
</p>
{% include versions_footer.html %}



